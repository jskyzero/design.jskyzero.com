---
layout: post
title: PlayerMaker与关卡脚本
featured-img: besiege
mathjax: true
categories: [Unity, Summary]
---

制作关卡离不开脚本逻辑的组合，本文将以PlayeMaker为切入点谈谈脚本与关卡制作。

<!--more-->


# PlayerMaker与关卡脚本
`jskyzero` `2021/05/25`


## 工具的必要性

为什么我们需要一个工具来组织逻辑？

使用C#作为描述语言，借助UNITY引擎内部的MonoBehavior的“生命周期”逻辑，可以原生的访问所有接口，C#作为一门面向对象的高级编程语言的表达能力、架构能力。使用编程语言的调试灵活度，似乎可以作为默认的、同时也是极其强大的解决方案。

同样的，PlayMaker可以用来组织条件和逻辑操作，也是是逻辑的一种组织方式。


[![](https://mermaid.ink/img/eyJjb2RlIjoiZ3JhcGggTFJcbiAgICBBW-ino-WGs-aWueahiF0gLS0-fOWMheaLrHwgQihDIyDnvJblhpnpgLvovpHku6PnoIEpXG4gICAgQVvop6PlhrPmlrnmoYhdIC0tPnzljIXmi6x8IEIxKFBsYXlNYWtlciDnvJblhpnnirbmgIHot7PovawpXG4gICAgXG4gICAgQ3vlpoLkvZXor4Tku7fkuIDnp43op6PlhrPmlrnmoYh9XG4gICAgQyAtLT5EW-ihqOi-vuiDveWKm-W8ul1cbiAgICBEIC0tPkQxW1wi5o6l5Y-j5Liw5a-M77yM5Y-v6Ieq5a6a5LmJXCJdXG4gICAgRCAtLT5EMltcIumAu-i-kee7hOWQiOa1gei9rO-8jOiHqueUseW6pumrmFwiXVxuICAgIEQgLS0-RDNbXCLlj5jph4_vvIzmlK_mjIHkvb_nlKjlj5jph49cIl1cbiAgICBEIC0tPkQ0W1wi6YC76L6R5p2h5Lu25a6M5aSHXCJdXG5cbiAgICBDIC0tPkVb5piT57u05oqkXVxuICAgIEUgLS0-RTFb5Y-v6K-75oCnXVxuICAgIEUgLS0-RTJb5piT5a2m5LmgXVxuICAgIEUgLS0-RTBb5Y-v5aSN55SoXVxuICAgIEUgLS0-RTNb6LCD6K-V5a655piTXVxuICAgIEUgLS0-RTRbXCLmmJPkv67mlLnvvIzkv67mlLnlj6_mjqdcIl1cblxuICAgIEMgLS0-Rlvorr7orqHkvJjpm4VdXG4gICAgRiAtLT5GMVvmlbDnkIbpgLvovpHmqKHlnotdXG4gICAgRiAtLT5GMlvohJrmnKznlJ_lkb3lkajmnJ9dICAiLCJtZXJtYWlkIjp7InRoZW1lIjoiZGVmYXVsdCJ9LCJ1cGRhdGVFZGl0b3IiOmZhbHNlLCJhdXRvU3luYyI6dHJ1ZSwidXBkYXRlRGlhZ3JhbSI6ZmFsc2V9)](https://mermaid-js.github.io/mermaid-live-editor/edit/##eyJjb2RlIjoiZ3JhcGggTFJcbiAgICBBW-ino-WGs-aWueahiF0gLS0-fOWMheaLrHwgQihDIyDnvJblhpnpgLvovpHku6PnoIEpXG4gICAgQVvop6PlhrPmlrnmoYhdIC0tPnzljIXmi6x8IEIxKFBsYXlNYWtlciDnvJblhpnnirbmgIHot7PovawpXG4gICAgXG4gICAgQ3vlpoLkvZXor4Tku7fkuIDnp43op6PlhrPmlrnmoYh9XG4gICAgQyAtLT5EW-ihqOi-vuiDveWKm-W8ul1cbiAgICBEIC0tPkQxW1wi5o6l5Y-j5Liw5a-M77yM5Y-v6Ieq5a6a5LmJXCJdXG4gICAgRCAtLT5EMltcIumAu-i-kee7hOWQiOa1gei9rO-8jOiHqueUseW6pumrmFwiXVxuICAgIEQgLS0-RDNbXCLlj5jph4_vvIzmlK_mjIHkvb_nlKjlj5jph49cIl1cbiAgICBEIC0tPkQ0W1wi6YC76L6R5p2h5Lu25a6M5aSHXCJdXG5cbiAgICBDIC0tPkVb5piT57u05oqkXVxuICAgIEUgLS0-RTFb5Y-v6K-75oCnXVxuICAgIEUgLS0-RTJb5piT5a2m5LmgXVxuICAgIEUgLS0-RTBb5Y-vZnUneW9uZ11cbiAgICBFIC0tPkUzW-iwg-ivleWuueaYk11cbiAgICBFIC0tPkU0W1wi5piT5L-u5pS577yM5L-u5pS55Y-v5o6nXCJdXG5cbiAgICBDIC0tPkZb6K6-6K6h5LyY6ZuFXVxuICAgIEYgLS0-RjFb5pWw55CG6YC76L6R5qih5Z6LXVxuICAgIEYgLS0-RjJb6ISa5pys55Sf5ZG95ZGo5pyfXSAgIiwibWVybWFpZCI6IntcbiAgXCJ0aGVtZVwiOiBcImRlZmF1bHRcIlxufSIsInVwZGF0ZUVkaXRvciI6ZmFsc2UsImF1dG9TeW5jIjp0cnVlLCJ1cGRhdGVEaWFncmFtIjpmYWxzZX0)

与C#编写逻辑代码相比，PlayMaker突出的优点
+ 学习成本低：可视化，无需了解编程知识。
+ 可读性好：脱离于代码以外，状态一目了然。
+ 复用性好：无需额外的架构抽象

此外，上面提到的诸多场景也都有对应的一些功能和特性，如支持变量、有丰富的已有库等。

PlayMaker的局限性：
+ 状态机的局限性：
  + 包括复杂度提高以后的易读、修改成本
  + 状态机本身表达能力

## PlayMaker概览

接下里我们具体讨论一下PlayMaker的相关逻辑。

一个例子：

[![](https://mermaid.ink/img/eyJjb2RlIjoiZ3JhcGggVERcbiAgICBBW-eBr-aYr-eBreeahF0gLS0-fOW8gOeBr-WujOaIkHwgQlvnga_mmK_kuq7nmoRdXG4gICAgQiAtLT585YWz54Gv5a6M5oiQfCBBXG5cbiAgICBBMVvnga_mmK_nga3nmoRdIC0tPnzljIXlkKt8IEQo5byA54Gv5Yqo5L2cKVxuICAgIEQgLS0-IHzmiafooYzlrox8IEQxKOWFs-eBr-WujOaIkOS6i-S7tilcblxuICAgIEIxW-eBr-aYr-S6rueahF0tLT585YyF5ZCrfCBFKOWFs-eBr-WKqOS9nClcbiAgICBFIC0tPiB85omn6KGM5a6MfCBFMSjlhbPnga_lrozmiJDkuovku7YpIiwibWVybWFpZCI6eyJ0aGVtZSI6ImRlZmF1bHQifSwidXBkYXRlRWRpdG9yIjpmYWxzZSwiYXV0b1N5bmMiOnRydWUsInVwZGF0ZURpYWdyYW0iOmZhbHNlfQ)](https://mermaid-js.github.io/mermaid-live-editor/edit##eyJjb2RlIjoiZ3JhcGggVERcbiAgICBBW-eBr-aYr-eBreeahF0gLS0-fOW8gOeBr-WujOaIkHwgQlvnga_mmK_kuq7nmoRdXG4gICAgQiAtLT585YWz54Gv5a6M5oiQfCBBXG5cbiAgICBBMVvnga_mmK_nga3nmoRdIC0tPnzljIXlkKt8IEQo5byA54Gv5Yqo5L2cKVxuICAgIEQgLS0-IHzmiafooYzlrox8IEQxKOWFs-eBr-WujOaIkOS6i-S7tilcbiAgICBcbiAgICBCMVvnga_mmK_kuq7nmoRdLS0-fOWMheWQq3wgRSjlhbPnga_liqjkvZwpXG4gICAgRSAtLT4gfOaJp-ihjOWujHwgRTEo5YWz54Gv5a6M5oiQ5LqL5Lu2KSIsIm1lcm1haWQiOiJ7XG4gIFwidGhlbWVcIjogXCJkZWZhdWx0XCJcbn0iLCJ1cGRhdGVFZGl0b3IiOmZhbHNlLCJhdXRvU3luYyI6dHJ1ZSwidXBkYXRlRGlhZ3JhbSI6ZmFsc2V9)

例子中我们可以看到：

+ 使用状态作为基本组织单位，使用状态机的跳转组织逻辑
  + 状态中包含脚本操作
  + 脚本操作（或者外界行为）触发事件
  + 事件触发状态的跳转

<!-- ### 教程：灯的开关

+ 状态
+ 事件
+ 状态机的跳转
+ 操作：GUI组件（点击）
+ 事件


### 教程：宝箱的开关

+ 过渡状态
+ 操作：动画播放

### 教程：触发器

+ 触发器
+ 触发器脚本，事件
+ 操作：GUI TEXT

### 尝试：自定义脚本

+ 模板
+ 注释 -->

## 关卡与脚本抽象

先鸽了