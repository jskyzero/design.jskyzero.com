<!DOCTYPE html>
<html lang="en">
<!-- <meta http-equiv="Content-Security-Policy" content="default-src 'none'; script-src 'self'; style-src 'self' https://fonts.googleapis.com; img-src 'self'; font-src 'self' https://fonts.gstatic.com; connect-src 'self'; media-src 'self'; object-src 'self'; child-src 'self'; form-action 'none'; base-uri 'self'" /> -->
<!-- <meta http-equiv="Content-Security-Policy" content="script-src 'self' https://cdnjs.cloudflare.com; style-src 'self' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; connect-src 'self'; media-src 'self'; object-src 'self'; child-src 'self'; form-action 'none'; base-uri 'self'" /> -->
<meta http-equiv="X-XSS-Protection"  content="1;mode=block" always>
<meta http-equiv="Referrer-Policy" content="no-referrer, strict-origin-when-cross-origin"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>拆包看狮子猿AI设计 | 设计者笔记</title><!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="拆包看狮子猿AI设计" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="之前拆包看了只狼的狮子猿的一阶段动画，本文则会对怪物的AI进行一些讨论和分析，并对之前文章的一些错误结论进行勘误。" />
<meta property="og:description" content="之前拆包看了只狼的狮子猿的一阶段动画，本文则会对怪物的AI进行一些讨论和分析，并对之前文章的一些错误结论进行勘误。" />
<link rel="canonical" href="https://design.jskyzero.com/2023/10/10/sekiro_lion_tamarin_AI/" />
<meta property="og:url" content="https://design.jskyzero.com/2023/10/10/sekiro_lion_tamarin_AI/" />
<meta property="og:site_name" content="设计者笔记" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-10-10T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="拆包看狮子猿AI设计" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-10-10T00:00:00+00:00","datePublished":"2023-10-10T00:00:00+00:00","description":"之前拆包看了只狼的狮子猿的一阶段动画，本文则会对怪物的AI进行一些讨论和分析，并对之前文章的一些错误结论进行勘误。","headline":"拆包看狮子猿AI设计","mainEntityOfPage":{"@type":"WebPage","@id":"https://design.jskyzero.com/2023/10/10/sekiro_lion_tamarin_AI/"},"url":"https://design.jskyzero.com/2023/10/10/sekiro_lion_tamarin_AI/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" type="text/css" href="/assets/main-light.css"><!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-V2SSPG3YGX"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-V2SSPG3YGX');
</script><!-- high light -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/default.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
</head>
<body>
    <div class="container"><header>
  <div class="menu">
    <ul><li><a href="/">/Home</a></li><li><a href="/program/">/Program</a></li><li><a href="/github/">/Github</a></li><li><a href="/project/">/Project</a></li></ul>
  </div>
</header>
<main>
      <div id="index">
  <ul class="md-toc">
  <li class="md-toc-h1"><a href="#拆包看狮子猿ai设计">拆包看狮子猿AI设计</a>
    <ul>
      <li class="md-toc-h2"><a href="#初步的体验反推">初步的体验反推</a>
        <ul>
          <li class="md-toc-h3"><a href="#交错比例与招式cd">交错比例与招式CD</a></li>
          <li class="md-toc-h3"><a href="#用行为树的简单拟合">用行为树的简单拟合</a></li>
        </ul>
      </li>
      <li class="md-toc-h2"><a href="#基于lua的架构设计">基于LUA的架构设计</a></li>
      <li class="md-toc-h2"><a href="#感受与细节设计">感受与细节设计</a></li>
      <li class="md-toc-h2"><a href="#参考">参考</a></li>
    </ul>
  </li>
</ul>
  <p id="pro">
  
  <!-- <div class="categories"> -->
    
    
    <img src="https://img.shields.io/badge/动作游戏分析-blue.svg?style=flat" alt="">
    <!--  -->
    
  <!-- </div> -->
  
  <img src="https://img.shields.io/badge/作者-jskyzero-brightgreen.svg?style=flat" alt="">
  <img src="https://img.shields.io/badge/日期-2023/10/10-brightgreen.svg?style=flat" alt="">
</p>

</div>

<p>之前拆包看了<a href="https://design.jskyzero.com/2023/02/17/sekiro_lion_tamarin/">只狼的狮子猿的一阶段动画</a>，本文则会对怪物的AI进行一些讨论和分析，并对之前文章的一些错误结论进行勘误。</p>

<p>本文的目标是以狮子猿一阶段<strong>成熟完备的AI</strong>为例子，让读者能对动作游戏中AI的设计有一个初步的理解，并分析一些对实际工作中设计有启发的逻辑细节。本文会分为三个部分：初步的体验反推、拆包后对主AI分析的架构设计、以及细节和感受分析和讨论。</p>

<h1 id="拆包看狮子猿ai设计">拆包看狮子猿AI设计</h1>

<h2 id="初步的体验反推">初步的体验反推</h2>

<p>首个尝试，和狮子猿录了一段素材，用肉眼将动作与之前的状态机进行匹配，得到了如下的结果：</p>

<p><img src="/assets/img/gameplay/sekiro_lion_tamarion_ai/1.png" alt="" /></p>

<blockquote>
  <p>全程视频可参考：<a href="TODO">Bilibili 笨办法</a></p>
</blockquote>

<p>其中的标注和动画状态机对应如下表所示：</p>

<table>
  <thead>
    <tr>
      <th>标注</th>
      <th>类别</th>
      <th>动画</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>连段1</td>
      <td>花里胡哨类</td>
      <td>3019;3020</td>
    </tr>
    <tr>
      <td>连段2</td>
      <td>花里胡哨类</td>
      <td>3000;3001</td>
    </tr>
    <tr>
      <td>连段2.变种</td>
      <td>花里胡哨类</td>
      <td>3000</td>
    </tr>
    <tr>
      <td>连段3</td>
      <td>花里胡哨类</td>
      <td>3003;3004</td>
    </tr>
    <tr>
      <td>连段4</td>
      <td>花里胡哨类</td>
      <td>3021</td>
    </tr>
    <tr>
      <td>跳跃攻击</td>
      <td>记忆点类</td>
      <td>3014</td>
    </tr>
    <tr>
      <td>红光1</td>
      <td>记忆点类</td>
      <td>3016</td>
    </tr>
    <tr>
      <td>空窗期</td>
      <td>表演类</td>
      <td>四方向闪避位移</td>
    </tr>
    <tr>
      <td>空窗期</td>
      <td>表演类</td>
      <td>原地吼，3018</td>
    </tr>
  </tbody>
</table>

<h3 id="交错比例与招式cd">交错比例与招式CD</h3>

<p>从这个视频中我们可以得出一些初步的结论:</p>

<ul>
  <li>攻击与空隙交错，那么比例是？</li>
</ul>

<p><img src="/assets/img/gameplay/sekiro_lion_tamarion_ai/2.png" alt="" /></p>

<p>大体上，狮子猿会维持如上图所示【攻击，空窗期】这样的单元重复，以此营造出凶猛进攻和灵动移动结合的交手体验。</p>

<p>其中，攻击的长度观察为1-4个完整招式，而空窗期通常为一次闪避位移。</p>

<ul>
  <li>招式没有复读，那么CD是？</li>
</ul>

<p><img src="/assets/img/gameplay/sekiro_lion_tamarion_ai/3.png" alt="" /></p>

<p>将招式分别拆开，我们会发现同个招式没有连续两次出现的情况。观察两个招式之间的最短间隔时长（从上一个末尾到下一个的开始）：</p>

<table>
  <thead>
    <tr>
      <th>标注</th>
      <th>最短时间间隔约</th>
      <th>动画</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>连段1</td>
      <td>∞</td>
      <td>3019;3020</td>
    </tr>
    <tr>
      <td>连段2与变种</td>
      <td>6</td>
      <td>3000;3001</td>
    </tr>
    <tr>
      <td>连段3</td>
      <td>∞</td>
      <td>3003;3004</td>
    </tr>
    <tr>
      <td>连段4</td>
      <td>6</td>
      <td>3021</td>
    </tr>
    <tr>
      <td>跳跃攻击</td>
      <td>50</td>
      <td>3014</td>
    </tr>
    <tr>
      <td>红光1</td>
      <td>9</td>
      <td>3016</td>
    </tr>
    <tr>
      <td>空窗期</td>
      <td>5秒</td>
      <td>四方向闪避位移</td>
    </tr>
  </tbody>
</table>

<h3 id="用行为树的简单拟合">用行为树的简单拟合</h3>

<p>总结一些关键结论：</p>

<ol>
  <li>攻击行为与空窗期相间</li>
  <li>攻击行为自身有间隔</li>
</ol>

<p>我们可以使用行为树对这个<code class="language-plaintext highlighter-rouge">出招序列</code>进行一个简单的拟合：</p>

<p><img src="/assets/img/gameplay/sekiro_lion_tamarion_ai/4.png" alt="" /></p>

<p>这个决策逻辑相当简单，这段战斗也只是一个序列，都充满着局限性，不过还是做一个思考练习，如何让这个逻辑变得更好？</p>

<ul>
  <li>与战斗进程挂钩的空窗间隔</li>
</ul>

<p>简单来说，通过控制空窗期的CD来控制玩家的战斗压力，结合一个能反映玩家战斗进程的数值——比如血量或者时间，就可以形成差异化的心流体验或者战斗历程。</p>

<ul>
  <li>更加复杂且细致的条件</li>
</ul>

<p>和上面的思路类似，我们可以为不同的技能设置除了CD以外更加细致的条件，比如关联自身血量，对于只狼来说，基础重要属性还有自身的架势槽；对于一个常规的动作游戏，还可以关联敌我的空间位置关系。</p>

<ul>
  <li>攻击前的调整位置</li>
</ul>

<p>对于一个动作游戏，招式的适用打击距离，一般是有限的。比如一个前冲拳，能冲的距离可能最多4米，那么对于4米外的目标，可能就需要先靠近目标再释放，不然就会形成空挥的体验（当然，空挥也是一种体验！）。对于4米内过近的目标，可能也需要先远离，避免一些不好的表现。</p>

<p>当然这部分可以通过设置招式前的距离检测来避免。这些检测相应的也会造成限制，这是一个取舍问题。</p>

<ul>
  <li>小结</li>
</ul>

<p>以传统而经典的行为树配置方法的话，对狮子猿AI的分析大致如上所述。当然，文章的长度已经出卖了作者，下文才是本次分析的重点，但是上文所叙述一些分析方法乃至思路也是相当重要的。</p>

<p>那么话不多说，我们来看看拆包/反编译后的狮子猿AI的LUA脚本。</p>

<h2 id="基于lua的架构设计">基于LUA的架构设计</h2>

<h2 id="感受与细节设计">感受与细节设计</h2>

<h2 id="参考">参考</h2>



<pre class="post-content controls__inner git-log"><output>~: git log
27 Oct 2023 - jskyzero - add 初步的体验反推
26 Oct 2023 - jskyzero - 📝 update 拆包看狮子猿AI设计
10 Oct 2023 - jskyzero - add 拆包看狮子猿AI设计

<img alt="Creative Commons License" src="/assets/img/CC.png" />

This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0 License</a>.
</output></pre>


<script src="/assets/js/main.js"></script>
<div id="disqus_thread"></div>
<script>

var disqus_config = function () {
this.page.url = 'https://design.jskyzero.com/2023/10/10/sekiro_lion_tamarin_AI/';
this.page.identifier = 'https://design.jskyzero.com/2023/10/10/sekiro_lion_tamarin_AI/';
};

(function() {
var d = document, s = d.createElement('script');
s.src = 'https://designer-notes.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the comments.</noscript>


    </main><footer>
  <p>Enjoy :)</p>
  <img src="https://img.shields.io/github/last-commit/jskyzero/design.jskyzero.com">
  <img style="border-radius: 4px;"
  src="https://hits.dwyl.com/jskyzero/designjskyzerocom.svg?style=flat-square">
  <br>
  <p>&copy; 2017-2023 设计者笔记. All rights reserved.</p>
  
</footer>
</div>
  </body>
</html>
