<!DOCTYPE html>
<html lang="en">
<!-- <meta http-equiv="Content-Security-Policy" content="default-src 'none'; script-src 'self'; style-src 'self' https://fonts.googleapis.com; img-src 'self'; font-src 'self' https://fonts.gstatic.com; connect-src 'self'; media-src 'self'; object-src 'self'; child-src 'self'; form-action 'none'; base-uri 'self'" /> -->
<!-- <meta http-equiv="Content-Security-Policy" content="script-src 'self' https://cdnjs.cloudflare.com; style-src 'self' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; connect-src 'self'; media-src 'self'; object-src 'self'; child-src 'self'; form-action 'none'; base-uri 'self'" /> -->
<meta http-equiv="X-XSS-Protection"  content="1;mode=block" always>
<meta http-equiv="Referrer-Policy" content="no-referrer, strict-origin-when-cross-origin"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>游戏AI架构的常用技巧 | 设计者笔记</title><!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="游戏AI架构的常用技巧" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="一些游戏AI设计制作时候的思维方式和技巧，主要来自GameAIPro的这篇文章" />
<meta property="og:description" content="一些游戏AI设计制作时候的思维方式和技巧，主要来自GameAIPro的这篇文章" />
<link rel="canonical" href="https://design.jskyzero.com/2022/05/24/GameAISkill/" />
<meta property="og:url" content="https://design.jskyzero.com/2022/05/24/GameAISkill/" />
<meta property="og:site_name" content="设计者笔记" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-05-24T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="游戏AI架构的常用技巧" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-05-24T00:00:00+00:00","datePublished":"2022-05-24T00:00:00+00:00","description":"一些游戏AI设计制作时候的思维方式和技巧，主要来自GameAIPro的这篇文章","headline":"游戏AI架构的常用技巧","mainEntityOfPage":{"@type":"WebPage","@id":"https://design.jskyzero.com/2022/05/24/GameAISkill/"},"url":"https://design.jskyzero.com/2022/05/24/GameAISkill/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" type="text/css" href="/assets/main.css"><!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-V2SSPG3YGX"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-V2SSPG3YGX');
</script></head>
<body>
    <div class="container"><header>
  <div class="menu">
    <ul><li><a href="/">/Home</a></li><li><a href="/program/">/Program</a></li><li><a href="/github/">/Github</a></li><li><a href="/project/">/Project</a></li></ul>
  </div>
</header>
<main>
      <div id="index">
  <ul class="md-toc">
  <li class="md-toc-h1"><a href="#游戏ai架构的常用技巧">游戏AI架构的常用技巧</a>
    <ul>
      <li class="md-toc-h2"><a href="#mn复杂度的解法分治">M*N复杂度的解法：分治</a></li>
      <li class="md-toc-h2"><a href="#捡完芝麻不丢西瓜行为栈">捡完芝麻不丢西瓜：行为栈</a></li>
      <li class="md-toc-h2"><a href="#多维度复杂条件的决策评估函数">多维度复杂条件的决策：评估函数</a></li>
      <li class="md-toc-h2"><a href="#通过知识引入智能黑板变量">通过知识引入智能：黑板变量</a></li>
      <li class="md-toc-h2"><a href="#适合的人干适合的事模块化">适合的人干适合的事：模块化</a></li>
      <li class="md-toc-h2"><a href="#总结灵活使用解决问题">总结：灵活使用解决问题</a></li>
    </ul>
  </li>
</ul>
  

</div>

<p>一些游戏AI设计制作时候的思维方式和技巧，主要来自<strong>GameAIPro</strong>的<a href="http://www.gameaipro.com/GameAIPro/GameAIPro_Chapter05_Structural_Architecture_Common_Tricks_of_the_Trade.pdf">这篇文章</a></p>

<h1 id="游戏ai架构的常用技巧">游戏AI架构的常用技巧</h1>

<h2 id="mn复杂度的解法分治">M*N复杂度的解法：分治</h2>

<p>游戏AI开发的一个核心难点就是应对逐渐上升的复杂度。</p>

<p>当新的环境，或者新的行为添加到现有体系，其复杂度多为M*N乘法系数上升。</p>

<p><img src="/assets/img/skill/GameAISkill/1-1.svg" alt="" /></p>

<blockquote>
  <p>举例：
当现有移动，防御，技能A，技能B，4种行为后增加一种技能C
由于技能B可以衔接在任意一种行为后（，当然也可能是前），将会增加4种需要思考的情况</p>
</blockquote>

<p>而使用分治法，则可以有效降低这种情况下扩张的新组合选项个数，使其变为N的常数级。</p>

<p><img src="/assets/img/skill/GameAISkill/1-2.svg" alt="" /></p>

<blockquote>
  <p>举例：
将移动，防御，划分为休闲动作
将技能A，技能B划分为攻击行为，2种行为大类后增加一种技能C
则只需要增加2种需要思考的情况</p>
</blockquote>

<p>同样的思路也出现在<strong>状态机</strong>与<strong>分层状态机</strong>上：状态机互相的连线在状态过多时无法维护，也不能很好的支持复用，于是有了分层状态机。</p>

<h2 id="捡完芝麻不丢西瓜行为栈">捡完芝麻不丢西瓜：行为栈</h2>

<p>栈是一种常见的数据结构，其核心特征是先进后出（，类似的数据结构队列是先进先出）。</p>

<p><img src="/assets/img/skill/GameAISkill/2-1.svg" alt="" /></p>

<p>利用先进后出的特性，我们可以为AI引入<strong>上下文</strong>的时间维度概念。</p>

<blockquote>
  <p>举例：
怪物在执行【靠近】-&gt;【攻击】的逻辑
【靠近】过程中发现一个攻击利器：棒球棒，可以触发【捡武器】行为</p>
</blockquote>

<p><img src="/assets/img/skill/GameAISkill/2-2.svg" alt="" /></p>

<p>如果没有历史信息：可能会重新进行决策来判断当前行为，这可能会带来行为的更改！之前要攻击，现在可能就是移动发呆了。</p>

<p><img src="/assets/img/skill/GameAISkill/2-3.svg" alt="" /></p>

<p>如果有历史信息（以栈结构为例）：则可以继续上一次没有执行完的动作（其中捡完武器，是否重新决策是可选环节）</p>

<p><img src="/assets/img/skill/GameAISkill/2-4.svg" alt="" /></p>

<p>本质上是上下文知识的记忆，只是运用栈的结构，可以自然的实现行为与历史相关这一目的。</p>

<h2 id="多维度复杂条件的决策评估函数">多维度复杂条件的决策：评估函数</h2>

<p>我们迟早会遇到多种条件复合的决策情形，这会相当复杂而且容易出错。</p>

<blockquote>
  <p>举例：
条件：自身血量，目标血量，自身与目标距离
行为：攻击，逃跑，……</p>
</blockquote>

<p>方便理解，我们列出一张枚举表格：</p>

<table>
  <thead>
    <tr>
      <th>自身血量</th>
      <th>目标血量</th>
      <th>距离</th>
      <th>行为</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>血量健康</td>
      <td>血量健康</td>
      <td>近</td>
      <td>攻击</td>
    </tr>
    <tr>
      <td>血量健康</td>
      <td>血量健康</td>
      <td>远</td>
      <td>攻击</td>
    </tr>
    <tr>
      <td>血量健康</td>
      <td>血量不健康</td>
      <td>近</td>
      <td>攻击</td>
    </tr>
    <tr>
      <td>血量健康</td>
      <td>血量不健康</td>
      <td>远</td>
      <td>攻击</td>
    </tr>
    <tr>
      <td>血量不健康</td>
      <td>血量健康</td>
      <td>近</td>
      <td>逃跑</td>
    </tr>
    <tr>
      <td>血量不健康</td>
      <td>血量健康</td>
      <td>远</td>
      <td>逃跑</td>
    </tr>
    <tr>
      <td>血量不健康</td>
      <td>血量不健康</td>
      <td>近</td>
      <td>攻击</td>
    </tr>
    <tr>
      <td>血量不健康</td>
      <td>血量不健康</td>
      <td>远</td>
      <td>逃跑</td>
    </tr>
  </tbody>
</table>

<p>根据怪物血量的性格（胆小怕死或者无畏自杀），擅长发起攻击的距离，等等要素，我们可以一一决策各种情形下的行为。多样化的行为！这正是游戏AI的魅力。</p>

<p>但是多数情况下，我们是没能力使用枚举维护复杂复合情况下的决策的（参考第一部分使用分治降低复杂度），也或者说：这是性价比比较低的方式。</p>

<p>本质上，我们是建立复合参数到固定行为的一种映射，所以我们可以使用<strong>函数</strong>的思想。</p>

<p><img src="/assets/img/skill/GameAISkill/3-1.svg" alt="" /></p>

<p>将每一个条件（离散值或者连续值）进行值的映射，并为其赋予一个乘法缩放系数，再通过值的求和来考虑所有条件的影响。</p>

<p><img src="/assets/img/skill/GameAISkill/3-2.svg" alt="" /></p>

<p>这样，我们就可以通过最终值来决策。避免决策调试与配置的复杂度。</p>

<h2 id="通过知识引入智能黑板变量">通过知识引入智能：黑板变量</h2>

<p>什么是智能？一个简单的解释是能够运用历史经验。也即储存知识。</p>

<p>我们可以使用变量来记录象征着知识的值，这不仅可以方便我们在运行时记录知识。</p>

<blockquote>
  <p>举例：</p>
  <ol>
    <li>记录本次释放指定行为的次数，控制释放总数</li>
    <li>记录环境信息或者对方行为信息，采取对应的行为</li>
  </ol>
</blockquote>

<p>也可以方便灵活使用变量来提高计算与配置的效率</p>

<blockquote>
  <p>举例：</p>
  <ol>
    <li>缓存复合结果到变量，而不在每个使用到的地方复合求值</li>
    <li>传递变量让同一个节点产生差异性的行为，以此做到更好的抽象与复用</li>
  </ol>

</blockquote>

<h2 id="适合的人干适合的事模块化">适合的人干适合的事：模块化</h2>

<p>好的关卡是模块化的，好的AI也是，这不仅是第一部分说到的分治的思想。也包括：</p>

<p>将复杂度下放到其他逻辑模块。</p>

<blockquote>
  <p>举例：</p>
  <ol>
    <li>复杂的转向、动作组合跳转，直接使用定制动作配置</li>
    <li>寻路放到单独的寻路模块、镜头放入镜头模块，AI只作为内容的使用方</li>
  </ol>
</blockquote>

<p>将知识储存到场景中。</p>

<blockquote>
  <p>举例：
场景中包含可交互物与交互方法，这样就把交互逻辑与逻辑主题分开，方便组合、更新。</p>
</blockquote>

<h2 id="总结灵活使用解决问题">总结：灵活使用解决问题</h2>

<p>AI有着多种技术架构与架构对应擅长的逻辑表达，有些时候面临的是工具的表达能力的问题。但是更多时候面对的是复杂情况的逻辑实现问题，灵活使用上述思维方式和技巧，能解决对应的复杂问题。</p>



<pre class="post-content controls__inner git-log"><output>~: git log
17 Jun 2022 - jskyzero - 🚚 update index
10 Jun 2022 - jskyzero - 📝 修改错别字
09 Jun 2022 - jskyzero - 📝 修改措辞
08 Jun 2022 - jskyzero - finish 游戏AI开发技巧
08 Jun 2022 - jskyzero - update 游戏AI开发技巧
07 Jun 2022 - jskyzero - update 游戏AI开发技巧
07 Jun 2022 - jskyzero - add 分治法
07 Jun 2022 - jskyzero - add some index
24 May 2022 - jskyzero - 📝 add 游戏AI开发技巧

<img alt="Creative Commons License" src="/assets/img/CC.png" />

This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0 License</a>.
</output></pre>


<script src="/assets/js/main.js"></script>
<div id="disqus_thread"></div>
<script>

var disqus_config = function () {
this.page.url = 'https://design.jskyzero.com/2022/05/24/GameAISkill/';
this.page.identifier = 'https://design.jskyzero.com/2022/05/24/GameAISkill/';
};

(function() {
var d = document, s = d.createElement('script');
s.src = 'https://designer-notes.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the comments.</noscript>


    </main><footer>
  <p>Enjoy :)</p>
  <span>&copy; 2022 设计者笔记. All rights reserved.</span>
</footer>
</div>
  </body>
</html>
