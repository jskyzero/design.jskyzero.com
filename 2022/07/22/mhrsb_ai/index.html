<!DOCTYPE html>
<html lang="en">
<!-- <meta http-equiv="Content-Security-Policy" content="default-src 'none'; script-src 'self'; style-src 'self' https://fonts.googleapis.com; img-src 'self'; font-src 'self' https://fonts.gstatic.com; connect-src 'self'; media-src 'self'; object-src 'self'; child-src 'self'; form-action 'none'; base-uri 'self'" /> -->
<!-- <meta http-equiv="Content-Security-Policy" content="script-src 'self' https://cdnjs.cloudflare.com; style-src 'self' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; connect-src 'self'; media-src 'self'; object-src 'self'; child-src 'self'; form-action 'none'; base-uri 'self'" /> -->
<meta http-equiv="X-XSS-Protection"  content="1;mode=block" always>
<meta http-equiv="Referrer-Policy" content="no-referrer, strict-origin-when-cross-origin"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>动作分析：怪猎AI设计 | 设计者笔记</title><!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="动作分析：怪猎AI设计" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="以拆包和体验来推导一下怪物猎人的AI出招逻辑，感受可能是市面上PVE动作游戏TTK最长、规则最丰富的单局战斗体验！" />
<meta property="og:description" content="以拆包和体验来推导一下怪物猎人的AI出招逻辑，感受可能是市面上PVE动作游戏TTK最长、规则最丰富的单局战斗体验！" />
<link rel="canonical" href="https://design.jskyzero.com/2022/07/22/mhrsb_ai/" />
<meta property="og:url" content="https://design.jskyzero.com/2022/07/22/mhrsb_ai/" />
<meta property="og:site_name" content="设计者笔记" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-07-22T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="动作分析：怪猎AI设计" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-07-22T00:00:00+00:00","datePublished":"2022-07-22T00:00:00+00:00","description":"以拆包和体验来推导一下怪物猎人的AI出招逻辑，感受可能是市面上PVE动作游戏TTK最长、规则最丰富的单局战斗体验！","headline":"动作分析：怪猎AI设计","mainEntityOfPage":{"@type":"WebPage","@id":"https://design.jskyzero.com/2022/07/22/mhrsb_ai/"},"url":"https://design.jskyzero.com/2022/07/22/mhrsb_ai/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" type="text/css" href="/assets/main-light.css"><!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-V2SSPG3YGX"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-V2SSPG3YGX');
</script><!-- high light -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/default.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
</head>
<body>
    <div class="container"><header>
  <div class="menu">
    <ul><li><a href="/">/Home</a></li><li><a href="/program/">/Program</a></li><li><a href="/github/">/Github</a></li><li><a href="/project/">/Project</a></li></ul>
  </div>
</header>
<main>
      <div id="index">
  <ul class="md-toc">
  <li class="md-toc-h1"><a href="#怪物猎人ai设计">怪物猎人AI设计</a>
    <ul>
      <li class="md-toc-h2"><a href="#前言">前言</a></li>
      <li class="md-toc-h2"><a href="#拆包">拆包</a>
        <ul>
          <li class="md-toc-h3"><a href="#繁多的状态机">繁多的状态机</a></li>
          <li class="md-toc-h3"><a href="#盲人摸象">盲人摸象</a></li>
        </ul>
      </li>
      <li class="md-toc-h2"><a href="#体验反推">体验反推</a></li>
    </ul>
  </li>
</ul>
  <p id="pro">
  
  <!-- <div class="categories"> -->
    
    
    <img src="https://img.shields.io/badge/游戏分析-blue.svg?style=flat" alt="">
    <!--  -->
    
  <!-- </div> -->
  
  <img src="https://img.shields.io/badge/作者-jskyzero-brightgreen.svg?style=flat" alt="">
  <img src="https://img.shields.io/badge/日期-2022/07/22-brightgreen.svg?style=flat" alt="">
</p>

</div>

<p>以拆包和体验来推导一下怪物猎人的AI出招逻辑，感受可能是市面上PVE动作游戏TTK最长、规则最丰富的单局战斗体验！</p>

<!--more-->

<h1 id="怪物猎人ai设计">怪物猎人AI设计</h1>

<h2 id="前言">前言</h2>

<p>如果要参考学习动作游戏PVE的BOSS设计的话，我想怪猎系列的怪物可能是绕不开的一个课题，它有着相对简单的关卡设计，衬托出纯度更高的战斗、丰富的机制与动作，带来反复游玩的乐趣。在MHW这一作，它经受住了大环境下ACT品类没落的考验，一跃成为了ACT游戏中最耀眼的明星之一。</p>

<p>本文将<strong>从拆包、体验反推两个视角</strong>来窥视怪物猎人的AI，聚焦在一些AI出招的逻辑设计、和这些设计是如何影响玩家的体验的。文章末尾会对比这两种方式，聊聊它俩各自的特点，在游戏反拆时适用的场合。</p>

<h2 id="拆包">拆包</h2>

<p>基本上，只要<strong>有MOD的游戏，就代表玩家群体已经掌握了游戏文件组织的大体结构</strong>——毕竟MOD，就是把玩家的内容，替换、修改厂商的内容，得先弄明白文件放到哪里，才能放过去让文件生效。对于大多数对MOD没有积极持支持态度的游戏开发商，这往往意味着已经有一个工具可以针对玩家的二进制分发文件进行解密解压缩处理。</p>

<p>感谢卡普空从MHW以来对PC的友好态度，MHW/MHWIB、MHR/MHRSB，都有着相当多的外观、易用性MOD，繁荣的MOD当然也就意味着，玩家对游戏文件有着相当的了解，从Github、NEXUSMODS上顺藤摸瓜成功找到了MHRSB的<a href="https://github.com/mhvuze/MonsterHunterRiseModding">MOD教程</a>，里面自然有<a href="https://github.com/mhvuze/MonsterHunterRiseModding/wiki/Extracting-Game-Files-(PC)">拆包过程的说明</a>，事不宜迟，拆了看看AI配置吧！</p>

<h3 id="繁多的状态机">繁多的状态机</h3>

<p>从<code class="language-plaintext highlighter-rouge">re_chunk_000\natives\STM\enemy\em001\</code>就可以定位到具体怪物，查一下<a href="https://github.com/mhvuze/MonsterHunterRiseModding/wiki/Monster-IDs">怪物ID表</a>，001是Rathian，也就是我们的老朋友——雌火龙。</p>

<p>对于一只具体的怪物，解包后的文件目录如下，我们关注的也就是<code class="language-plaintext highlighter-rouge">ai_fsm_user_data</code>下的文件，fsm，看起来底层驱动的技术是有限状态机。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">.</span>
├── 00
│   ├── ai_fsm_user_data
│   ├── collision
│   ├── mod
│   ├── mot
│   ├── prefab
│   ├── shell
│   ├── user_data
│   └── user_variables
├── 02
├── 07
└── common
    ├── act_tbl_user_data
    ├── mod
    ├── mot
    ├── motion_fsm
    └── user_data
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">ai_fsm_user_data</code>下的文件就多起来了，以<code class="language-plaintext highlighter-rouge">em001\00\ai_fsm_user_data</code>的为例，有多达125个文件：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">.</span>
├── flow
│   └── em001_00_predator_relevant_action.user.2
├── hub
│   ├── damage
│   │   ├── fly
│   │   │   ├── em001_00_fly_element_weak_damage.user.2
│   │   │   ├── em001_00_fly_em2em_damage.user.2
│   │   │   └── ...
│   │   └── stand
│   │       ├── em001_00_stand_element_weak_damage.user.2
│   │       ├── em001_00_stand_em2em_damage.user.2
│   │       └── ...
│   ├── die
│   │   ├── fly
│   │   │   ├── em001_00_fly_capture.user.2
│   │   │   └── em001_00_fly_normal_die.user.2
│   │   └── stand
│   │       ├── em001_00_stand_capture.user.2
│   │       └── em001_00_stand_normal_die.user.2
│   ├── em001_00_arrange.user.2
│   ├── em001_00_arrange_hyakuryu.user.2
│   └── ...
└── think
    ├── em001_00_damage.user.2
    ├── em001_00_die.user.2
    └── ...

9 directories, 125 files
</code></pre></div></div>

<p>很可惜，目前的用于编辑拆包后的<code class="language-plaintext highlighter-rouge">.user.2</code>类型文件的<a href="https://github.com/Synthlight/MHR-Editor">MHR Editor</a>，尚且不支持这些AI文件，姑且用<code class="language-plaintext highlighter-rouge">HexEditor</code>试着看了下一些文件的内容，看到了一些类似USR开头、RSZ用作分割之类的信息，但是也没有啥有价值的内容。</p>

<p><img src="/assets/img/gameplay/mhrsb.AI/HexEditor.jpg" alt="" /></p>

<p>看不到具体的文件，就只能看看能不能从文件名中间得到些信息了。</p>

<h3 id="盲人摸象">盲人摸象</h3>

<h2 id="体验反推">体验反推</h2>

<p>以下施工中……</p>



<pre class="post-content controls__inner git-log"><output>~: git log
26 May 2023 - jskyzero - finish 繁多的状态机 part
26 May 2023 - jskyzero - update 前言 & 拆包
17 May 2023 - jskyzero - 📝 start 拆包 part
11 May 2023 - jskyzero - update index in 动作分析：怪猎AI设计
18 Jan 2023 - jskyzero - 🐛 hide unfinished works
05 Dec 2022 - jskyzero - 📝 add long-term-maintenance
07 Oct 2022 - jskyzero - update pro tag
18 Sep 2022 - jskyzero - update mh part
02 Sep 2022 - jskyzero - update 怪物猎人的战斗数值设计
22 Jul 2022 - jskyzero - 📝 add mhrsb ai

<img alt="Creative Commons License" src="/assets/img/CC.png" />

This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0 License</a>.
</output></pre>


<script src="/assets/js/main.js"></script>
<div id="disqus_thread"></div>
<script>

var disqus_config = function () {
this.page.url = 'https://design.jskyzero.com/2022/07/22/mhrsb_ai/';
this.page.identifier = 'https://design.jskyzero.com/2022/07/22/mhrsb_ai/';
};

(function() {
var d = document, s = d.createElement('script');
s.src = 'https://designer-notes.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the comments.</noscript>


    </main><footer>
  <p>Enjoy :)</p>
  <span>&copy; 2017-2023 设计者笔记. All rights reserved.</span>
</footer>
</div>
  </body>
</html>
